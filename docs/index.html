
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Finite Volume Method for Nonlinear Nonlocal Equations documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="finite-volume-method-for-nonlinear-nonlocal-equations">
<h1>Finite Volume Method for Nonlinear Nonlocal Equations<a class="headerlink" href="#finite-volume-method-for-nonlinear-nonlocal-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="documentations">
<h2>Documentations<a class="headerlink" href="#documentations" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<span id="document-single"></span><div class="section" id="single-species">
<h3>Single Species<a class="headerlink" href="#single-species" title="Permalink to this headline">¶</a></h3>
<div class="section" id="file-structure">
<h4>File Structure<a class="headerlink" href="#file-structure" title="Permalink to this headline">¶</a></h4>
<p><strong>Main file</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>/diffusion2d/single/single2d.m</dt>
<dd>main function for numeric simulation of the dynamics of one single species in 2D</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p><strong>ALso include</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>/diffusion2d/single/minmod.m</dt>
<dd>a generalized minmod limiter function</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/single/drho.m</dt>
<dd>gives the time derivative of the density function at given configuration</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/single/draw.m</dt>
<dd>a help function for 3D visualization</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/single/SSPRK3.m</dt>
<dd>SSP-RK3 method</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/single/Euler.m</dt>
<dd>Euler method</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p><strong>Examples</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>/diffusion2d/single/Example1.m</dt>
<dd><a class="reference internal" href="index.html#example1"><span class="std std-ref">Example 1</span></a></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/single/Example2.m</dt>
<dd><a class="reference internal" href="index.html#example2"><span class="std std-ref">Example 2</span></a></dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h4>
<div class="topic">
<p class="topic-title first">single2d</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="p">=</span> <span class="n">single2d</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>SINGLE2D:</dt>
<dd>numeric simulation of the dynamics of one single species in 2D</dd>
</dl>
<p>Input:</p>
<blockquote>
<div><ul class="simple">
<li>rho0:        initial density, N by N matrix</li>
<li>L:          domain [-L,L] x [-L,L]</li>
<li>W:          W(x) interacting potentials</li>
<li>dt:         time step</li>
<li>T:          simulation time. Total #iterations = T/dt</li>
</ul>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><ul class="simple">
<li>rho:        density at t = T, N by N matrix</li>
</ul>
</div></blockquote>
<p>Optional parm:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="p">=</span> <span class="n">single2d</span><span class="p">(..</span> <span class="p">,</span><span class="n">H</span><span class="p">);</span>

<span class="hll"><span class="c">%   H is a symbolic function for internal energy as a</span>
</span><span class="hll"><span class="c">%   function of the density. Default H(r) = 0</span>
</span><span class="o">--------------------------------------------------------------------------</span>

<span class="n">rho</span> <span class="p">=</span> <span class="n">single2d</span><span class="p">(..</span> <span class="p">,</span><span class="n">V</span><span class="p">);</span>

<span class="hll"><span class="c">%   optionally sets the environmental confinement potential V,</span>
</span><span class="hll"><span class="c">%   which is a NxNmatrix. Default: 0</span>
</span><span class="o">--------------------------------------------------------------------------</span>

<span class="n">rho</span> <span class="p">=</span> <span class="n">single2d</span><span class="p">(..</span> <span class="p">,</span><span class="n">e</span><span class="p">)</span>

<span class="hll"><span class="c">%   sets the diffusion coefficient for some e &gt; 0. Default e = 0</span>
</span><span class="o">--------------------------------------------------------------------------</span>

<span class="n">rho</span> <span class="p">=</span> <span class="n">single2d</span><span class="p">(..</span> <span class="p">,</span><span class="s">&#39;v&#39;</span><span class="p">)</span> <span class="n">or</span> <span class="n">rho</span> <span class="p">=</span> <span class="n">single2d</span><span class="p">(..</span> <span class="p">,</span><span class="s">&#39;V&#39;</span><span class="p">)</span>

<span class="hll"><span class="c">%   enables visual display during the simulation. Default disabled.</span>
</span><span class="o">--------------------------------------------------------------------------</span>

<span class="n">rho</span> <span class="p">=</span> <span class="n">single2d</span><span class="p">(..</span> <span class="p">,</span><span class="s">&#39;solver&#39;</span><span class="p">)</span>

<span class="hll"><span class="c">%   where &#39;solver&#39; sets the numeric method used for ODE.</span>
</span><span class="hll"><span class="c">%   Possible options: &#39;Euler&#39;, &#39;SSPRK3&#39;. Default &#39;SSPRK3&#39;.</span>
</span><span class="o">--------------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="topic">
<p class="topic-title first">drho</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">dr</span> <span class="p">=</span> <span class="n">drho</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>DRHO:</dt>
<dd>gives time derivative of the density function evaluated at r</dd>
</dl>
<p>Input:</p>
<blockquote>
<div><ul class="simple">
<li>r:          density distribution</li>
<li>K:          convolution matrix</li>
<li>dH:         a symbolic function of the derivative of H</li>
<li>V:          matrix of confinement potential</li>
<li>dx:         time step</li>
<li>e:          diffusion coefficient</li>
</ul>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><ul class="simple">
<li>dr:        time derivative of the density function</li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<span id="document-two"></span><div class="section" id="two-species">
<h3>Two Species<a class="headerlink" href="#two-species" title="Permalink to this headline">¶</a></h3>
<div class="section" id="file-structure">
<h4>File Structure<a class="headerlink" href="#file-structure" title="Permalink to this headline">¶</a></h4>
<p><strong>Main file</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>/diffusion2d/two/two2d.m</dt>
<dd>main function for numeric simulation of the dynamics of two species in 2D</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p><strong>ALso include</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>/diffusion2d/two/minmod.m</dt>
<dd>a generalized minmod limiter function</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/two/drho2.m</dt>
<dd>gives the time derivatives of the density functions at given configuration</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/two/draw.m</dt>
<dd>a help function for 3D visualization</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/two/SSPRK3.m</dt>
<dd>SSP-RK3 method</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/two/Euler.m</dt>
<dd>Euler method</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p><strong>Examples</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>/diffusion2d/two/Example_two_pulses.m</dt>
<dd><a class="reference internal" href="index.html#two-pul"><span class="std std-ref">Two Pulses Example</span></a></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>/diffusion2d/two/Example_three_pulses.m</dt>
<dd><a class="reference internal" href="index.html#three-pul"><span class="std std-ref">Three Pulses Example</span></a></dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h4>
<div class="topic">
<p class="topic-title first">two2d</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="p">=</span> <span class="n">two2d</span><span class="p">(</span><span class="n">r1_0</span><span class="p">,</span><span class="n">r2_0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>TWO2D:</dt>
<dd>numeric simulation of the dynamics of two species in 2D</dd>
</dl>
<p>Input:</p>
<blockquote>
<div><ul class="simple">
<li>r1_0,r2_0:  initial density of the two species, N by N matrix</li>
<li>L:          domain [-L,L] x [-L,L]</li>
<li>W:          W(x) interacting potentials</li>
<li>dt:         time step</li>
<li>T:          simulation time. Total #iterations = T/dt</li>
</ul>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><ul class="simple">
<li>r1, r2:        densities at t = T, N by N matrix</li>
</ul>
</div></blockquote>
<p>Optional parm:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="p">=</span> <span class="n">two2d</span><span class="p">(..</span> <span class="p">,</span><span class="n">H</span><span class="p">);</span>

<span class="hll"><span class="c">%   H is a symbolic function for internal energy as a</span>
</span><span class="hll"><span class="c">%   function of the density. Default H(r) = 0</span>
</span><span class="o">--------------------------------------------------------------------------</span>

<span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="p">=</span> <span class="n">two2d</span><span class="p">(..</span> <span class="p">,</span><span class="n">V</span><span class="p">);</span>

<span class="hll"><span class="c">%   optionally sets the environmental confinement potential V,</span>
</span><span class="hll"><span class="c">%   which is a NxNmatrix. Default: 0</span>
</span><span class="o">--------------------------------------------------------------------------</span>

<span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="p">=</span> <span class="n">two2d</span><span class="p">(..</span> <span class="p">,</span><span class="n">e</span><span class="p">)</span>

<span class="hll"><span class="c">%   sets the diffusion coefficient for some e &gt; 0. Default e = 0</span>
</span><span class="o">--------------------------------------------------------------------------</span>

<span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="p">=</span> <span class="n">two2d</span><span class="p">(..</span> <span class="p">,</span><span class="s">&#39;v&#39;</span><span class="p">)</span> <span class="n">or</span> <span class="n">rho</span> <span class="p">=</span> <span class="n">single2d</span><span class="p">(..</span> <span class="p">,</span><span class="s">&#39;V&#39;</span><span class="p">)</span>

<span class="hll"><span class="c">%   enables visual display during the simulation. Default disabled.</span>
</span><span class="o">--------------------------------------------------------------------------</span>

<span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="p">=</span> <span class="n">two2d</span><span class="p">(..</span> <span class="p">,</span><span class="s">&#39;solver&#39;</span><span class="p">)</span>

<span class="hll"><span class="c">%   where &#39;solver&#39; sets the numeric method used for ODE.</span>
</span><span class="hll"><span class="c">%   Possible options: &#39;Euler&#39;, &#39;SSPRK3&#39;. Default &#39;SSPRK3&#39;.</span>
</span><span class="o">--------------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="topic">
<p class="topic-title first">drho2</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">dr</span> <span class="p">=</span> <span class="n">drho2</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">K11</span><span class="p">,</span><span class="n">K12</span><span class="p">,</span><span class="n">K21</span><span class="p">,</span><span class="n">K22</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>DRHO2:</dt>
<dd>gives time derivatives of the density functions evaluated at r</dd>
</dl>
<p>Input:</p>
<blockquote>
<div><ul class="simple">
<li>r:          density distribution</li>
<li>K:          convolution matrix</li>
<li>dH:         a symbolic function of the derivative of H</li>
<li>V:          matrix of confinement potential</li>
<li>dx:         time step</li>
<li>e:          diffusion coefficient</li>
</ul>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><ul class="simple">
<li>dr:        time derivative of the density function</li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<span id="document-examples"></span><div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="section" id="example-1">
<span id="example1"></span><h4>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="p">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="n">dx</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="n">T</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">X</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">dx</span><span class="p">:</span><span class="n">l</span><span class="o">-</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">Y</span> <span class="p">=</span> <span class="n">X</span><span class="p">.</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">N</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>

<span class="n">rho0</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">rho0</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;</span><span class="mi">3</span> <span class="o">&amp;</span> <span class="n">X</span><span class="o">&gt;-</span><span class="mi">3</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&lt;</span><span class="mi">3</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&gt;-</span><span class="mi">3</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
<span class="n">syms</span> <span class="n">W</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">W</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">x</span>^<span class="mi">2</span> <span class="o">-</span> <span class="n">y</span>^<span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="nb">pi</span><span class="p">;</span>
<span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">=</span> <span class="n">x</span>^<span class="mi">3</span><span class="o">/</span><span class="mi">30</span><span class="p">;</span>

<span class="n">rhoR</span> <span class="p">=</span> <span class="n">single2d</span> <span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="s">&#39;v&#39;</span><span class="p">,</span> <span class="n">H</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2">
<span id="example2"></span><h4>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">dx</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="n">T</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">X</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">dx</span><span class="p">:</span><span class="n">l</span><span class="o">-</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">Y</span> <span class="p">=</span> <span class="n">X</span><span class="p">.</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">N</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>

<span class="n">rho0</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">rho0</span><span class="p">(</span><span class="n">X</span><span class="o">&lt;</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">X</span><span class="o">&gt;-</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&lt;</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">syms</span> <span class="n">W</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">W</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="n">x</span>^<span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="nb">log</span><span class="p">(</span><span class="n">x</span>^<span class="mi">2</span> <span class="o">+</span> <span class="n">y</span>^<span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span>^<span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

<span class="n">rhoR</span> <span class="p">=</span> <span class="n">single2d</span> <span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="s">&#39;v&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c">%set diffusion coeff to 0</span>

<span class="n">rhoRp</span> <span class="p">=</span> <span class="n">single2d</span> <span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="n">l</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="s">&#39;v&#39;</span><span class="p">,</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">dx</span>^<span class="mi">2</span><span class="p">);</span> <span class="c">%set diffusion coeff to 0.4*dx^2</span>
</pre></div>
</div>
</div>
<div class="section" id="two-pulses-example">
<span id="two-pul"></span><h4>Two Pulses Example<a class="headerlink" href="#two-pulses-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">dx</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">l</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">m1</span> <span class="p">=</span> <span class="mf">1.5</span><span class="p">;</span>
<span class="n">m2</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">e</span> <span class="p">=</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="n">dx</span><span class="p">;</span>
<span class="n">T</span> <span class="p">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.002</span><span class="p">;</span>
<span class="n">N</span> <span class="p">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span>

<span class="n">syms</span> <span class="n">x</span> <span class="n">y</span><span class="p">;</span>
<span class="n">W12</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">x</span>^<span class="mi">2</span><span class="o">+</span><span class="n">y</span>^<span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">W21</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="n">W12</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
<span class="n">W11</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">x</span>^<span class="mi">2</span><span class="o">+</span><span class="n">y</span>^<span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">W22</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="n">W11</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
<span class="n">W</span><span class="p">.</span><span class="n">W11</span> <span class="p">=</span> <span class="n">W11</span><span class="p">;</span> <span class="n">W</span><span class="p">.</span><span class="n">W22</span> <span class="p">=</span> <span class="n">W22</span><span class="p">;</span> <span class="n">W</span><span class="p">.</span><span class="n">W21</span> <span class="p">=</span> <span class="n">W21</span><span class="p">;</span> <span class="n">W</span><span class="p">.</span><span class="n">W12</span> <span class="p">=</span> <span class="n">W12</span><span class="p">;</span>

<span class="n">X</span> <span class="p">=</span> <span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">dx</span><span class="p">:</span><span class="n">l</span><span class="o">-</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">X</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
<span class="n">Y</span> <span class="p">=</span> <span class="n">X</span><span class="p">.</span><span class="o">&#39;</span><span class="p">;</span>

<span class="n">r1_0</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">r1_0</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">X</span> <span class="o">&amp;</span> <span class="n">X</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">&lt;</span><span class="n">Y</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">=</span> <span class="n">m1</span><span class="p">;</span>
<span class="n">r2_0</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">r2_0</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;</span><span class="n">X</span> <span class="o">&amp;</span> <span class="n">X</span><span class="o">&lt;</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">&lt;</span><span class="n">Y</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">=</span> <span class="n">m2</span><span class="p">;</span>

<span class="n">r1</span> <span class="p">=</span> <span class="n">r1_0</span><span class="p">;</span>
<span class="n">r2</span> <span class="p">=</span> <span class="n">r2_0</span><span class="p">;</span>

<span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="p">=</span> <span class="n">two2d</span> <span class="p">(</span> <span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">W</span> <span class="p">,</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span><span class="s">&#39;v&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="three-pulses-example">
<span id="three-pul"></span><h4>Three Pulses Example<a class="headerlink" href="#three-pulses-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">dx</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">l</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">m</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">m1</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span>
<span class="n">m2</span> <span class="p">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span>
<span class="c">% e = 0;</span>
<span class="n">e</span> <span class="p">=</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="n">dx</span><span class="p">;</span>
<span class="n">nt</span> <span class="p">=</span> <span class="mi">2000</span><span class="p">;</span>
<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.002</span><span class="p">;</span>
<span class="n">N</span> <span class="p">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span>

<span class="n">syms</span> <span class="n">x</span> <span class="n">y</span> <span class="n">H</span><span class="p">;</span>
<span class="n">W12</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span>^<span class="mi">2</span><span class="o">+</span><span class="n">y</span>^<span class="mi">2</span><span class="p">);</span>
<span class="n">W21</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="n">W12</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
<span class="n">W11</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">x</span>^<span class="mi">2</span><span class="o">+</span><span class="n">y</span>^<span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">W22</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">=</span> <span class="n">W11</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
<span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">V</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>



<span class="n">X</span> <span class="p">=</span> <span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">dx</span><span class="p">:</span><span class="n">l</span><span class="o">-</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">X</span> <span class="p">=</span> <span class="nb">meshgrid</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
<span class="n">Y</span> <span class="p">=</span> <span class="n">X</span><span class="p">.</span><span class="o">&#39;</span><span class="p">;</span>

<span class="n">r1_0</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">r1_0</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">&lt;</span><span class="n">X</span> <span class="o">&amp;</span> <span class="n">X</span><span class="o">&lt;</span><span class="mf">0.5</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">&lt;</span><span class="n">Y</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">=</span> <span class="n">m</span><span class="p">;</span>
<span class="n">r2_0</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">r2_0</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">X</span> <span class="o">&amp;</span> <span class="n">X</span><span class="o">&lt;-</span><span class="mf">0.5</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">&lt;</span><span class="n">Y</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">=</span> <span class="n">m1</span><span class="p">;</span>
<span class="n">r2_0</span><span class="p">(</span><span class="mf">0.5</span><span class="o">&lt;</span><span class="n">X</span> <span class="o">&amp;</span> <span class="n">X</span><span class="o">&lt;</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">&lt;</span><span class="n">Y</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">=</span> <span class="n">m2</span><span class="p">;</span>

<span class="n">r1</span> <span class="p">=</span> <span class="n">r1_0</span><span class="p">;</span>
<span class="n">r2</span> <span class="p">=</span> <span class="n">r2_0</span><span class="p">;</span>
<span class="n">r</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">nt</span>
    <span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">]</span> <span class="p">=</span> <span class="n">two2d</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span> <span class="n">W11</span><span class="p">,</span><span class="n">W12</span><span class="p">,</span><span class="n">W22</span><span class="p">,</span><span class="n">W21</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">e</span><span class="p">);</span>
    <span class="k">if</span> <span class="n">any</span><span class="p">(</span><span class="n">r1</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">|</span> <span class="n">r2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">end</span>
    <span class="n">s</span> <span class="p">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;attr_attr%03d.mat&#39;</span><span class="p">,</span><span class="nb">i</span><span class="p">);</span>
    <span class="n">r</span><span class="p">(:,:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">r1</span><span class="p">;</span>
    <span class="n">r</span><span class="p">(:,:,</span><span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="n">r2</span><span class="p">;</span>
    <span class="n">save</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">);</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><strong>Model Description:</strong> For N groups in a 2D space, let <span class="math notranslate nohighlight">\(\rho_i(\mathbf{x}, t)\)</span> denotes the mass density distribution of group <em>i</em>
at time <em>t</em>, <span class="math notranslate nohighlight">\(i=1,2,...,N\)</span>. The problem we are interested in:</p>
<div class="math notranslate nohighlight">
\[\partial_t\rho_i = \nabla\cdot\Big[\rho_i\nabla\Big(H'(\rho)+V(\mathbf{x})+W_{ii}\ast\rho_i+\sum\limits_{j\neq{i}}{W_{ij}\ast\rho_j}+\epsilon\rho\Big)\Big], \mathbf{x}\in\mathbb{R}^2, t\gt{0}\]</div>
<p><span class="math notranslate nohighlight">\(\mathbf{\rho_i}\)</span> : mass density of group <em>i</em></p>
<p><span class="math notranslate nohighlight">\(\mathbf{\rho}\)</span>: <span class="math notranslate nohighlight">\(\sum{\rho_i}\)</span> , sum of densities of all N groups</p>
<p><span class="math notranslate nohighlight">\(\mathbf{H(\rho)}\)</span>: density of internal energy</p>
<p><span class="math notranslate nohighlight">\(\mathbf{V(\mathbf{x})}\)</span>: environmental confinement potential</p>
<p><span class="math notranslate nohighlight">\(\mathbf{W_{ii}}\)</span>: self-interaction potential (intraspecific interaction potential)</p>
<p><span class="math notranslate nohighlight">\(\mathbf{W_{ij}}(j\neq{i})\)</span>: cross-interaction potential (interspecific interaction potential)</p>
<p><span class="math notranslate nohighlight">\(\mathbf{\epsilon}\)</span>: diffusion coefficient</p>
<p>with initial condition <span class="math notranslate nohighlight">\(\rho_i(\mathbf{x},0)=\rho_{i0}(\mathbf{x})\)</span>.</p>
<p><strong>Numeric Analysis:</strong> This numeric scheme is developed based on the finite volume method described in <a class="reference internal" href="#links">Links</a> [2]. The paper proposes a
finite method scheme for nonlinear nonlocal system for a single group in one and two spacial dimensions. We extend the scheme to include more than one group,
with cross-interaction mechanism mentioned in <a class="reference internal" href="#links">Links</a> [3].</p>
<div class="topic">
<p class="topic-title first">System Requirements</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Software Requires</th>
<th class="head">MATLAB Release Compatibility</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>MATLAB</td>
<td>Created with R2018a</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="links">
<h2>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Source Code: <a class="reference external" href="github.com/uidmice/finiteVolumeMethod">Github</a></li>
<li>A Finite-Volume Method for Nonlinear Nonlocal Equations with a Gradient Flow Structure: <a class="reference external" href="http://de.arxiv.org/abs/1402.4252v2">arXiv:1402.4252v2</a></li>
<li>Zoology of a Nonlocal Cross-Diffusion Model for Two Species: <a class="reference external" href="https://doi.org/10.1137/17M1128782">Permalink</a></li>
</ol>
</div>
<div class="section" id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h2>
<p>If you are having issues, please email <a class="reference external" href="mailto:yydxhhuyi&#37;&#52;&#48;gmail&#46;com">mailto:yydxhhuyi<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html#document-index">Finite Volume Method for Nonlinear Nonlocal Equations</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-single">Single Species</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-two">Two Species</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-examples">Examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html#document-index">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Yi Hu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>